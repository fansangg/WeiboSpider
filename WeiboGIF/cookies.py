#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author: fansan
# @Date:   2016-05-05 15:21:59
# @Last Modified by:   fansan
# @Last Modified time: 2016-06-16 10:34:57

import json
import base64
import requests

# 填写微博账号密码 #
# 格式如下所示，no 代表账号, psw 代码密码
# 账号之间以逗号分隔
WeiBoAccount = [
    {'no': '13166795074', 'psw': 'a123456'},
    {'no': '13072490894', 'psw': 'a123456'},
    {'no': 'hclm4377080@163.com', 'psw': 'waejoruyd243335c'},
    {'no': 'nhxi0257716@163.com', 'psw': 'fjnswad262580l'},
    {'no': 'xge0037053@163.com', 'psw': 'ejnswa178578n'},
    {'no': 'qmqy810362@163.com', 'psw': 'vybfjmos7348m'},
    {'no': 'phaa6667333@163.com', 'psw': 'swafkptxd24477v'},
    {'no': 'jirere_i15063@163.com', 'psw': 'koswae2313n'},
    {'no': 'lanu_uhche13287@163.com', 'psw': 'puzdim5401w'},
    {'no': 'yingerrbo_3101@163.com', 'psw': 'jmquyb1076u'},
    {'no': 'jieob_oobai146@163.com', 'psw': 'svadil5873v'},
    {'no': 'yiqddddwei_7058@163.com', 'psw': 'inqtxa1245n'},
    {'no': '15011676189', 'psw': 'a123456'},
    {'no': '13067423749', 'psw': 'a123456'},
    {'no': '13276957461', 'psw': 'a123456'},
    {'no': '13275904025', 'psw': 'a123456'},
    {'no': '13020949413', 'psw': 'a123456'},
    {'no': '15710594279', 'psw': 'a123456'},
    {'no': '13285937004', 'psw': 'a123456'},
    {'no': '13276957489', 'psw': 'a123456'},
    {'no': '15710594360', 'psw': 'a123456'},
    {'no': '13276957774', 'psw': 'a123456'},
    {'no': '17716935619', 'psw': 'a123456'},
    {'no': '13067306146', 'psw': 'a123456'},
    {'no': '17716940297', 'psw': 'a123456'},
    {'no': '13075861473', 'psw': 'a123456'},
    {'no': '13290724692', 'psw': 'a123456'},
    {'no': '17716932406', 'psw': 'a123456'},
    {'no': '17716939734', 'psw': 'a123456'},
    {'no': '13030931974', 'psw': 'a123456'},
    {'no': '13105933914', 'psw': 'a123456'},
    {'no': '17716930573', 'psw': 'a123456'},
    {'no': '13030939374', 'psw': 'a123456'},
    {'no': '13030937124', 'psw': 'a123456'},
    {'no': '17716937280', 'psw': 'a123456'},
    {'no': '17716934467', 'psw': 'a123456'},
    {'no': '17716930481', 'psw': 'a123456'},
    {'no': '17716933751', 'psw': 'a123456'},
    {'no': '17716943872', 'psw': 'a123456'},
    {'no': '13067422349', 'psw': 'a123456'},
    {'no': '13285020004', 'psw': 'a123456'},
    {'no': '17716933024', 'psw': 'a123456'},
    {'no': '17716941683', 'psw': 'a123456'},
    {'no': '14705452639', 'psw': 'a123456'},
    {'no': '17716938901', 'psw': 'a123456'},
    {'no': '13067426431', 'psw': 'a123456'},
    {'no': '13225998746', 'psw': 'a123456'},
    {'no': '18363133204', 'psw': 'a123456'},
    {'no': '18650407480', 'psw': 'a123456'},
    {'no': '18363133154', 'psw': 'a123456'},
    {'no': '15097344914', 'psw': 'a123456'},
    {'no': '14705459399', 'psw': 'a123456'},
    {'no': '15097344933', 'psw': 'a123456'},
    {'no': '13285939413', 'psw': 'a123456'},
    {'no': '13030932364', 'psw': 'a123456'},
    {'no': '13040039046', 'psw': 'a123456'},
    {'no': '13030933234', 'psw': 'a123456'},
    {'no': '15511549305', 'psw': 'a123456'},
    {'no': '13030935754', 'psw': 'a123456'},
    {'no': '13105955944', 'psw': 'a123456'},
    {'no': '13285938546', 'psw': 'a123456'},
    {'no': '13276959246', 'psw': 'a123456'},
    {'no': '13040080431', 'psw': 'a123456'},
    {'no': '13276957048', 'psw': 'a123456'},
    {'no': '13276958147', 'psw': 'a123456'},
    {'no': '13057993458', 'psw': 'a123456'},
    {'no': '15658782418', 'psw': 'a123456'},
    {'no': '15658691840', 'psw': 'a123456'},
    {'no': '15324419139', 'psw': 'a123456'},
    {'no': '15658698849', 'psw': 'a123456'},
    {'no': '18196643304', 'psw': 'a123456'},
    {'no': '18133664596', 'psw': 'a123456'},
    {'no': '15309696445', 'psw': 'a123456'},
    {'no': '15658712945', 'psw': 'a123456'},
    {'no': '13057994126', 'psw': 'a123456'},
    {'no': '13074682160', 'psw': 'a123456'},
    {'no': '15658691401', 'psw': 'a123456'},
    {'no': '15658712489', 'psw': 'a123456'},
    {'no': '15658714007', 'psw': 'a123456'},
    {'no': '15658679482', 'psw': 'a123456'},
    {'no': '15658562416', 'psw': 'a123456'},
    {'no': '18954500815', 'psw': 'a123456'},
    {'no': '13040037724', 'psw': 'a123456'},
    {'no': '13040034879', 'psw': 'a123456'},
    {'no': '13040038429', 'psw': 'a123456'},
    {'no': '13040038144', 'psw': 'a123456'},
    {'no': '13040038140', 'psw': 'a123456'},
    {'no': '13030950214', 'psw': 'a123456'},
    {'no': '13030932824', 'psw': 'a123456'},
    {'no': '13285937437', 'psw': 'a123456'},
    {'no': '13276959345', 'psw': 'a123456'},
    {'no': '13276956465', 'psw': 'a123456'},
    {'no': '17806020497', 'psw': 'a123456'},
    {'no': '13218482131', 'psw': 'a123456'},
    {'no': '13003417103', 'psw': 'a123456'},
    {'no': '13003416521', 'psw': 'a123456'},
    {'no': '13003415282', 'psw': 'a123456'},
    {'no': '13218483682', 'psw': 'a123456'},
    {'no': '13218049113', 'psw': 'a123456'},
    {'no': '13218049709', 'psw': 'a123456'},
    {'no': '13218047290', 'psw': 'a123456'},
    {'no': '13218481697', 'psw': 'a123456'},
    {'no': '13003416229', 'psw': 'a123456'},
    {'no': '13003416328', 'psw': 'a123456'},
    {'no': '13218047063', 'psw': 'a123456'},
    {'no': '13003416791', 'psw': 'a123456'},
    {'no': '13003415676', 'psw': 'a123456'},
    {'no': '13218047075', 'psw': 'a123456'},
    {'no': '13003415583', 'psw': 'a123456'},
    {'no': '13218048961', 'psw': 'a123456'},
    {'no': '13218494204', 'psw': 'a123456'},
    {'no': '13218486263', 'psw': 'a123456'},
    {'no': '13218084363', 'psw': 'a123456'},

]


def getCookies(Account):
    """ 获取Cookies """
    cookies = []
    loginURL = r'https://login.sina.com.cn/sso/login.php?client=ssologin.js(v1.4.15)'
    for elem in Account:
        account = elem['no']
        password = elem['psw']
        username = base64.b64encode(account.encode('utf-8')).decode('utf-8')
        postData = {
            "entry": "sso",
            "gateway": "1",
            "from": "null",
            "savestate": "30",
            "useticket": "0",
            "pagerefer": "",
            "vsnf": "1",
            "su": username,
            "service": "sso",
            "sp": password,
            "sr": "1440*900",
            "encoding": "UTF-8",
            "cdult": "3",
            "domain": "sina.com.cn",
            "prelt": "0",
            "returntype": "TEXT",
        }
        session = requests.Session()
        r = session.post(loginURL, data=postData)
        jsonStr = r.content.decode('utf-8')
        info = json.loads(jsonStr)
        if info["retcode"] == "0":
            print "Get Cookie Success!( Account:%s )" % account
            cookie = session.cookies.get_dict()
            cookies.append(cookie)
        else:
            print "Failed!( Reason:%s )" % info['reason']
    return cookies

cookies = getCookies(WeiBoAccount)
print "Get Cookies Finish!( Num:%d)" % len(cookies)
